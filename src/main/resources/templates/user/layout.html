<html xmlns:th="http://www.thymeleaf.org"
      lang="en">

<head th:fragment="head">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Unicode Pleco</title>
    <link rel="ICON" href="/style/img/ico/favicon.ico" type="image/ico"/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="/style/css/bootstrap.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="/style/css/mdb.min.css" rel="stylesheet">
    <!-- Your custom styles (optional) -->
    <link href="/style/css/style.css" rel="stylesheet">
    <link href="/style/css/fileupload.css" rel="stylesheet">
    <!-- MDBootstrap Datatables  -->
    <link href="/style/css/addons/datatables.min.css" rel="stylesheet">
    <style>
        @font-face {
            font-family: headerFont;
            src: url(/style/img/font/ostrich-sans-dashed.ttf);
        }

        @font-face {
            font-family: uom;
            src: url(/style/img/font/Lato-Regular.ttf);
        }


    </style>
    <script type="text/javascript">
        var myVar;

        function loaderFunction() {
            myVar = setTimeout(showPage, 2000);
        }

        function showPage() {
            document.getElementById("loader").style.display = "none";
            document.getElementById("content").style.display = "block";
        }
    </script>
</head>

<body onload="loaderFunction()">

<div class="wrapper" id="loader" th:fragment="loader">
    <div id="rotater"></div>

    <div class="sliding-background">
        <div class="moveVertically">
            <div class="moveHorizontaly">
                <img class="flipAround" src="/style/img/loader-pleco.png"
                     alt="pleco unicode document converter by ciperlabs/tachyon techologies and university of Moratuwa">
            </div>
        </div>
        <div class="moveVertically-late">
            <div class="moveHorizontaly-late">
                <img class="flipAround-late" src="/style/img/loader-pleco.png"
                     alt="pleco unicode document converter by ciperlabs/tachyon techologies and university of Moratuwa">

            </div>
        </div>
    </div>
</div>
</div>

<div class="animate-bottom container-fluid" id="content" style="display: none">
    <!-- chatbot -->
    <div id="fb-root" th:fragment="chatbot"></div>

    <div class="row" th:fragment="navbar">
        <!-- Load Facebook SDK for JavaScript -->
        <script>
            window.fbAsyncInit = function () {
                FB.init({
                    appId: '285080992197803',
                    autoLogAppEvents: true,
                    xfbml: true,
                    version: 'v2.11'
                });
            };
        </script>
        <script>(function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js';
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));</script>

        <!-- Your customer chat code -->
        <div class="fb-customerchat"
             attribution=setup_tool
             page_id="1949172665132215"
             theme_color="#fa3c4c">
        </div>
        <div class="col-xl-12" style="padding :0%">
            <!-- nav bar -->
            <nav class="mb-1 navbar navbar-expand-lg navbar-dark #b71c1c red darken-4 ">
                <a class="navbar-brand" href="#">Unicode Pleco</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarSupportedContent-333"
                        aria-controls="navbarSupportedContent-333" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent-333">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item" id="home_link">
                            <a class="nav-link" href="/">Home
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item" id="about_link">
                            <a class="nav-link" href="/about">About Us
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item" id="issue_link">
                            <a class="nav-link" href="/report_issue">Report an Issue
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item" id="advanced_link">
                            <a class="nav-link" href="/advanced_conversion">Advanced Conversions
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                    </ul>
                    <ul class="navbar-nav ml-auto nav-flex-icons">
                        <li class="nav-item active">
                            <a class="nav-link" href="https://www.facebook.com/Unicode-Pleco-1949172665132215/"
                               target="_blank" style="margin-top: 4px">
                                <i class="fab fa-facebook-f"></i> Find us on Facebook
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li class="nav-item dropdown authenticated">
                            <a class="nav-link dropdown-toggle" id="navbarDropdownMenuLink-4" data-toggle="dropdown"
                               aria-haspopup="true"
                               aria-expanded="false">
                                <img src="" class="rounded float-left" id="profilePic" style="width: 40px"> <span
                                    id="user"></span> </a>
                            <div class="dropdown-menu dropdown-menu-right dropdown-info"
                                 aria-labelledby="navbarDropdownMenuLink-4">
                                <!--<a class="dropdown-item" href="#">My account</a>-->
                                <a class="dropdown-item" onClick="logout()">Log out</a>
                            </div>

                        </li>
                        <li class="nav-item dropdown unauthenticated">

                            <a type="button" class="nav-link active" data-toggle="modal" data-target="#fbSignInForm">
                                Login
                            </a>

                        </li>
                    </ul>
                </div>
            </nav>
            <!-- end of nav bar -->
            <div class="modal fade" id="fbSignInForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                 aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title w-100 font-weight-bold">Sign In to Continue</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="row">
                            <div class="col-sm-8 offset-2">
                                <div class="row">
                                    <div class="col-sm-4 offset-1">
                                        <img src="style/img/logo/logoUoM.png" class="img-fluid "
                                             alt="pleco unicode document converter by ciperlabs/tachyon techologies and university of Moratuwa">
                                    </div>
                                    <div class="col-sm-6 offset-1">
                                        <img src="style/img/logo/Pleco.jpg" class="img-fluid "
                                             alt="pleco unicode document converter by ciperlabs/tachyon techologies and university of Moratuwa">
                                    </div>
                                </div>

                            </div>

                        </div>
                        <hr class="half-rule">
                        <div class="modal-body mx-3">
                            <div class="row justify-content-center">
                                <p> We will <strong>never </strong> post on your timeline.</p>
                                <p> We will <strong>never </strong> share your credentials with anyone.</p>
                                <p> This is <strong>only </strong> required so that we can reply to your issues/
                                    suggestions.</p>
                                <p> We are <strong>not a partner</strong> of Facebook Family.</p>
                                <a type="button" class="btn btn-lg  btn-fb"
                                   style="background-color: #4267B2"
                                   href="/login/facebook">
                                    <span class="align-content-center" style="font-weight: bold; font-size: large">
                                    <i class="fab fa-facebook pr-1 fa-2x"></i>&nbsp;Continue with Facebook</span></a>
                            </div>

                        </div>
                        <div class="modal-footer d-flex justify-content-center">
                            <button class="btn" onclick="$('#fbSignInForm').modal('toggle')"><i
                                    class="far fa-times-circle"></i>&nbsp;Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
    <div class="row" th:fragment="heading">
        <!-- inner nav bar -->
        <div class="container">
            <!-- <br/> -->
            <br/>
            <div class="row">
                <div class="col-md-5">
                    <div class="row">
                        <div class="col-md-3">
                            <a href="https://www.mrt.ac.lk/web/" target="_blank">
                                <img src="style/img/logo/logoUoM.png" style="width :120px; height : 120px"
                                     alt="pleco unicode document converter by Tachyon Technologies an university of Moratuwa">
                            </a>
                        </div>
                        <div class="col-md-9" style="padding-left: 5%">
                            <div class="row">
                                <p style="font-size:29px;font-family: uom  ;font-weight:700;line-height:1.1; margin-bottom:2px;  color:#252525;">
                                    University of Moratuwa</p>
                                <p style="font-size:13px;font-family: uom; font-weight:600;">Wisdom is all wealth</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4" style="padding-left :0%">
                    <p style="font-size:75px;font-family:headerFont;font-weight:700;line-height:1.1;color:#252525;">
                        Unicode Pleco</p>
                </div>
                <div class="col-md-3">
                    <a href="#">
                        <img src="/style/img/logo/Pleco.jpg"
                             alt="pleco unicode document converter by Tachyon Technologies and university of Moratuwa">
                    </a>
                </div>
            </div>
        </div>

        <!-- end of inner nav bar -->
    </div>

    <div class="row">
        <div class="col-md-2" th:fragment="leftBar">
            <p style="font-size:20px;font-family: uom;">Supported Fonts</p>
            <ul class="list-group">
                <li class="list-group-item active #b71c1c red darken-4">News</li>
                <li class="list-group-item"><a href="/about#fonts">Supported Fonts</a></li>
                <li class="list-group-item"><a href="https://www.mrt.ac.lk/web/" target="_blank">UOM</a></li>
                <li class="list-group-item"><a href="https://tachyontec.io/" target="_blank">Tachyons Tec.</a></li>
                <li class="list-group-item"><a href="/about#supported">Supported Documents</a></li>
                <li class="list-group-item"><h6 style="color:red;">Now Supports PDF to docx Conversion!</h6></li>
            </ul>
        </div>

        <div class="col-md-2" th:fragment="rightBar">
            <div class="col">
                <div class="counter">
                    <i class="fa fa-lightbulb-o fa-2x"></i>
                    <h2 class="timer count-title count-number" id="visitorCount" data-to="" data-speed="1500"></h2>
                    <p class="count-text ">Number Of Visitors</p>
                </div>
            </div>
        </div>
    </div>

    <!--content goes here-->

    <div class="row">&nbsp</div>
    <div class="row" th:fragment="footer">

        <!-- Footer -->

        <div class="col-xl-12" style="padding :0%">
            <!-- Footer -->
            <footer class="page-footer font-small #b71c1c red darken-4 pt-4">

                <!-- Footer Links -->
                <div class="container-fluid text-center text-md-left">
                    <!-- Grid row -->
                    <div class="row">
                        <!-- Grid column -->
                        <div class="col-md-6 mt-md-0 mt-3">
                            <!-- Content -->
                            <h5 class="text-uppercase">Welcome</h5>
                            <p>Unicode pleco is a universal Sinhala/Tamil non unicode to unicode docx converter. The
                                project was initiated by Center for Natural Language Processing in University of
                                Moratuwa
                                and developed by Tachyon Technologies. The name "Pleco" was derived from "Plecostomus".
                                "Pleco" is a fish who cleans dirt/algae in the water. We clean the non-unicode
                                text from your files like a Pleco cleans the dirt in water"
                            </p>
                        </div>
                        <!-- Grid column -->
                        <hr class="clearfix w-100 d-md-none pb-3">
                        <!-- Grid column -->
                        <div class="col-md-3 mb-md-0 mb-3">
                            <!-- Links -->
                            <h5 class="text-uppercase">Quick Links</h5>
                            <ul class="list-unstyled">
                                <li>
                                    <a href="https://www.mrt.ac.lk/web/nlp" target="_blank">NLP Center</a>
                                </li>
                                <li>
                                    <a href="https://www.mrt.ac.lk/" target="_blank">University of Moratuwa</a>
                                </li>
                                <li>
                                    <a href="https://tachyontec.io/" target="_blank">Tachyon Technologies</a>
                                </li>
                                <li>
                                    <a href="/about#supported">Supported Fonts</a>
                                </li>
                            </ul>

                        </div>
                        <!-- Grid column -->
                        <!-- Grid column -->
                        <div class="col-md-3 mb-md-0 mb-3">
                            <!-- Links -->
                            <h5 class="text-uppercase">Contact Us</h5>

                            <ul class="list-unstyled">
                                <li>
                                    <p>Feel free to send us your comments, suggessions and report issues through our
                                        facebook page or mail box.</p>
                                </li>
                                <li>
                                    <a href="https://www.facebook.com/Unicode-Pleco-1949172665132215/">Facebook</a>
                                </li>
                                <li>
                                    <a href="mailto:nlu@uom.lk">nlu@uom.lk</a>
                                </li>
                            </ul>
                        </div>
                        <!-- Grid column -->


                    </div>
                    <!-- Grid row -->

                </div>
                <!-- Footer Links -->

                <!-- Copyright -->
                <div class="footer-copyright text-center py-3">© 2019 Developed by <a href="https://tachyontec.io/"
                                                                                      target="_blank">Tachyon Technologies</a> for
                    <a href="https://www.mrt.ac.lk/"> University of Moratuwa. </a>All rights Reserved.
                </div>
                <!-- Copyright -->

            </footer>
        </div>
    </div>
</div>
<div th:fragment="scripts">
    <!-- SCRIPTS -->
    <!-- JQuery -->
    <script type="text/javascript" src="/style/js/jquery-3.3.1.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="/style/js/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="/style/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="/style/js/mdb.min.js"></script>
    <link rel="stylesheet" href="/style/css/dropzone.css">
    <script type="text/javascript" src="/style/js/dropzone.js"></script>
    <!-- MDBootstrap Datatables  -->
    <script type="text/javascript" src="/style/js/addons/datatables.min.js"></script>
    <!-- <link rel="stylesheet" href="style.css"> -->

    <script type="text/javascript">
        $(document).ready(function () {
            function animateloop() {
                $("#progressinner").css({marginLeft: "-45%"});
                $("#progressinner").animate({
                    marginLeft: "145%"
                }, 2000, function () {
                    animateloop()
                });
            }

            animateloop();
        });
    </script>
    <script type="text/javascript" src="/webjars/js-cookie/js.cookie.js"></script>
    <script type="text/javascript">

        $.ajaxSetup({
            beforeSend: function (xhr, settings) {
                if (settings.type == 'POST' || settings.type == 'PUT'
                    || settings.type == 'DELETE') {
                    if (!(/^http:.*/.test(settings.url) || /^https:.*/
                        .test(settings.url))) {
                        // Only send the token to relative URLs i.e. locally.
                        xhr.setRequestHeader("X-XSRF-TOKEN", Cookies
                            .get('XSRF-TOKEN'));
                    }
                }
            }
        });
        $.get("/user", function (data) {
            $("#user").html(data.name);
            $("#profilePic").attr("src", data.picture);
            console.log(data.picture);
            if (data.name == undefined) {
                logout();
            } else {
                $(".unauthenticated").hide();
                $(".authenticated").show();
                localStorage.setItem("status", "success");

            }
        });
        var logout = function () {
            $.post("/logout", function () {
                $("#user").html('');
                $(".unauthenticated").show();
                $(".authenticated").hide();
                localStorage.setItem("status", "notLoggedIn");

            });
            return true;
        };
    </script>
    <script type="text/javascript">

        var visitorCountElm = document.getElementById("visitorCount");

        var visitRecord = localStorage.getItem("visitRecord");
        var old = false;

        var head = document.getElementsByTagName('head')[0];
        var js = document.createElement("script");

        js.type = "text/javascript";
        js.src = "/style/js/visitorCount.js";


        console.log("VisitorCountObj : " + visitRecord);

        if (visitRecord === undefined || visitRecord === "" || visitRecord == null) {
            var object = {visited: "true", timestamp: new Date().getTime()};
            localStorage.setItem("visitRecord", JSON.stringify(object));
            console.log("Adding visitor log");
            var old = true;
        }
        else {
            console.log("Previouly visited");
            var object = JSON.parse(visitRecord);
            var date = object.timestamp;

            console.log(date);

            var day = 1000 * 60 * 60 * 24;
            var dayOld = Date.now() - day;

            if (date > dayOld) {
                // Still not 1 day old
                old = false;
                console.log("Previouly visited");

            }
            else {
                // older than one day
                console.log("Previouly visited not");

                old = true;
                var object = {visited: "true", timestamp: new Date().getTime()};
                localStorage.setItem("visitRecord", JSON.stringify(object));
            }

        }
        var formData = new FormData();
        formData.append("newVisitor", old);
        $.ajax({
            type: "POST",
            url: "/visitor",
            success: function (data) {
                // your callback here
                console.log("Visitor Count : " + data.visitorCount.toString());
                visitorCountElm.setAttribute("data-to", data.visitorCount.toString());
                // visitorCountElm.innerText = data.visitorCount.toString();
                console.log(visitorCountElm);

                // Add Javascript after setting value
                head.appendChild(js);
            },
            error: function (error) {
                console.log("Error in the request or file.");
                // handle error
                console.log(error);

                visitorCountElm.setAttribute("data-to", "0");
                visitorCountElm.innerText = data.visitorCount.toString();

                // Add Javascript after setting value
                head.appendChild(js);

            },
            async: true,
            data: formData,
            cache: false,
            contentType: false,
            processData: false,
            timeout: 180000
        });

    </script>
    <!--<script type="text/javascript" src="/style/js/visitorCount.js"></script>-->


</div>
</body>

</html>

<!--/.Navbar -->